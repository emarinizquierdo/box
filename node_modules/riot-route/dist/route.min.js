(function(){"use strict";var t=function(t){t=t||{};var e={},n=Array.prototype.slice,i=function(t,e){t.replace(/\S+/g,e)},r=function(e,n){Object.defineProperty(t,e,{value:n,enumerable:false,writable:false,configurable:false})};r("on",function(n,r){if(typeof r!="function")return t;i(n,function(t,n){(e[t]=e[t]||[]).push(r);r.typed=n>0});return t});r("off",function(n,r){if(n=="*"&&!r)e={};else{i(n,function(t){if(r){var n=e[t];for(var i=0,f;f=n&&n[i];++i){if(f==r)n.splice(i--,1)}}else delete e[t]})}return t});r("one",function(e,n){function i(){t.off(e,i);n.apply(t,arguments)}return t.on(e,i)});r("trigger",function(r){var f=n.call(arguments,1),u;i(r,function(i){u=n.call(e[i]||[],0);for(var r=0,o;o=u[r];++r){if(o.busy)return;o.busy=1;o.apply(t,o.typed?[i].concat(f):f);if(u[r]!==o){r--}o.busy=0}if(e["*"]&&i!="*")t.trigger.apply(t,["*",i].concat(f))});return t});return t};var e=/^.+?\/+[^\/]+/,n="EventListener",i="remove"+n,r="add"+n,f="hasAttribute",u="replace",o="popstate",a="hashchange",c="trigger",s=3,l=typeof window!="undefined"&&window,h=typeof document!="undefined"&&document,p=l&&history,d=l&&(p.location||l.location),m=j.prototype,y=h&&h.ontouchstart?"touchstart":"click",v=false,g=t(),b=false,w,$,x,A,S,K=[],N=0;function O(t){return t.split(/[\/?#]/)}function T(t,e){var n=new RegExp("^"+e[u](/\*/g,"([^/?#]+?)")[u](/\.\./,".*")+"$"),i=t.match(n);if(i)return i.slice(1)}function E(t,e){var n;return function(){clearTimeout(n);n=setTimeout(t,e)}}function P(t){w=E(R,1);l[r](o,w);l[r](a,w);h[r](y,_);if(t)R(true)}function j(){this.$=[];t(this);g.on("stop",this.s.bind(this));g.on("emit",this.e.bind(this))}function k(t){return t[u](/^\/|\/$/,"")}function q(t){return typeof t=="string"}function D(t){return(t||d.href||"")[u](e,"")}function L(t){return $[0]=="#"?(t||d.href||"").split($)[1]||"":D(t)[u]($,"")}function R(t){var e=N==0;if(s<=N)return;N++;K.push(function(){var e=L();if(t||e!=x){g[c]("emit",e);x=e}});if(e){while(K.length){K[0]();K.shift()}N=0}}function _(t){if(t.which!=1||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;var n=t.target;while(n&&n.nodeName!="A")n=n.parentNode;if(!n||n.nodeName!="A"||n[f]("download")||!n[f]("href")||n.target&&n.target!="_self"||n.href.indexOf(d.href.match(e)[0])==-1)return;if(n.href!=d.href){if(n.href.split("#")[0]==d.href.split("#")[0]||$!="#"&&D(n.href).indexOf($)!==0||!z(L(n.href),n.title||h.title))return}t.preventDefault()}function z(t,e,n){if(p){t=$+k(t);e=e||h.title;n?p.replaceState(null,e,t):p.pushState(null,e,t);h.title=e;b=false;R();return b}return g[c]("emit",L(t))}m.m=function(t,e,n){if(q(t)&&(!e||q(e)))z(t,e,n||false);else if(e)this.r(t,e);else this.r("@",t)};m.s=function(){this.off("*");this.$=[]};m.e=function(t){this.$.concat("@").some(function(e){var n=(e=="@"?A:S)(k(t),k(e));if(typeof n!="undefined"){this[c].apply(null,[e].concat(n));return b=true}},this)};m.r=function(t,e){if(t!="@"){t="/"+k(t);this.$.push(t)}this.on(t,e)};var B=new j;var C=B.m.bind(B);C.create=function(){var t=new j;t.m.stop=t.s.bind(t);return t.m.bind(t)};C.base=function(t){$=t||"#";x=L()};C.exec=function(){R(true)};C.parser=function(t,e){if(!t&&!e){A=O;S=T}if(t)A=t;if(e)S=e};C.query=function(){var t={};var e=d.href||x;e[u](/[?&](.+?)=([^&]*)/g,function(e,n,i){t[n]=i});return t};C.stop=function(){if(v){if(l){l[i](o,w);l[i](a,w);h[i](y,_)}g[c]("stop");v=false}};C.start=function(t){if(!v){if(l){if(document.readyState=="complete")P(t);else l[r]("load",function(){setTimeout(function(){P(t)},1)})}v=true}};C.base();C.parser();window.route=C})();